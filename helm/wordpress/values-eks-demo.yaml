# EKS Demo values - minimal resources for small cluster
# Uses AWS Load Balancer Controller for native ALB integration

# Namespace configuration
namespace: wordpress-demo

# WordPress configuration
wordpress:
  image:
    repository: wordpress
    tag: "6.4.2-apache"
    pullPolicy: IfNotPresent

  # WordPress admin configuration
  username: admin
  password: "" # Auto-generated
  email: admin@example.com
  firstName: Admin
  lastName: User
  blogName: "EKS WordPress Demo"

  persistence:
    enabled: true
    storageClass: "gp2" # EKS default
    accessModes:
      - ReadWriteOnce
    size: 5Gi # Smaller for demo
  resources:
    limits:
      cpu: "200m"
      memory: "512Mi"
    requests:
      cpu: "50m"
      memory: "256Mi"

  # Health checks
  livenessProbe:
    enabled: true
    path: /wp-admin/install.php
    initialDelaySeconds: 120
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6

  readinessProbe:
    enabled: true
    path: /wp-admin/install.php
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6

# MySQL configuration
mysql:
  image:
    repository: mariadb # Lighter than MySQL
    tag: "10.11"
    pullPolicy: IfNotPresent

  # Database configuration
  database: wordpress
  user: wordpress
  password: "" # Auto-generated
  rootPassword: "" # Auto-generated

  persistence:
    enabled: true
    storageClass: "gp2" # EKS default
    accessModes:
      - ReadWriteOnce
    size: 5Gi # Smaller for demo
  resources:
    limits:
      cpu: "200m"
      memory: "256Mi"
    requests:
      cpu: "50m"
      memory: "128Mi"

# Service configuration - ClusterIP for ingress
service:
  type: ClusterIP
  port: 80

# Ingress configuration for AWS ALB (shared ALB for cost efficiency)
ingress:
  enabled: true
  className: alb
  annotations:
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/healthcheck-path: /wp-admin/install.php
    alb.ingress.kubernetes.io/group.name: shared-alb  # KEY: Enables ALB sharing
  hosts:
    - host: wordpress-demo.yourdomain.com
      paths:
        - path: /
          pathType: Prefix
  tls: []

# Initial replicas for demo (HPA will scale 2-10 based on load)
replicaCount: 2

# HPA configuration for demo
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 20
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

# Resource quotas configured for load testing demo
resourceQuota:
  requests:
    cpu: "2"
    memory: 4Gi
  limits:
    cpu: "4"
    memory: 8Gi
  persistentvolumeclaims: "5"
  pods: "20"

# Security configuration
security:
  podSecurityStandard:
    enforce: baseline
    audit: restricted
    warn: restricted

# Limit range configuration
limitRange:
  default:
    cpu: "200m"
    memory: "512Mi"
  defaultRequest:
    cpu: "50m"
    memory: "128Mi"

# Labels for demo
additionalLabels:
  environment: eks-demo
  team: platform
  app: wordpress
  version: "1.0"
# Load Testing Notes:
# - Use scripts/load-test-demo.sh to demonstrate HPA scaling
# - Resource quotas allow scaling up to 20 WordPress pods
# - HPA targets: CPU 80%, Memory 80%
# - Expected baseline: 2 pods (due to memory pressure)
# - Expected scaling: 2 â†’ 20 pods under load

# Ingress Notes:
# - Uses AWS Load Balancer Controller for native ALB integration
# - CRITICAL: Uses alb.ingress.kubernetes.io/group.name for ALB sharing
# - Single ALB handles multiple services (cost-effective)
# - Direct pod targeting for better performance
# - Leverages AWS-native features (WAF, Shield, ACM integration)
